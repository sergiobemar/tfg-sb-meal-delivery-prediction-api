# Meal Delivery Prediction - API

Repository to launch, deploy and maintain the API for the TFG project "Meal Delivery Prediction" used for showing the user every metrics and KPIs about the activity of the different center in their activity, delivery several meals. 

This API send the response from the requests sent by the[ ShinyApp deployed for this use case](https://github.com/sergiobemar/tfg-sb-meal-delivery-prediction), where the user can make several predictions about the number of orders which are estimated for the next 10 weeks.

## Anatomy

```
.
├── README.md				-The top-level README for developers using this project
├── .gitignore				- File containing folders & files to be ignored in the GIT repository (e.g. everything in data, models and reports folders)
├── api					- Folder with the code regarding the API server
│   ├── Dockerfile			- File used by Docker to generate the image of the API server launched by Gunicorn
│   ├── __init__.py			- Makes api a Python module
│   ├── app.py				- Script with Flask code to lauch manage the requests to the several endpoints
│   ├── data				- Files with the different datasets
│   │   ├── processed			- Processed datasets
│   │   └── raw				- Original datasets
│   ├── endpoints			- Scripts with the different endpoints that it's wanted to expose by the server
│   ├── models				- To save the models in binary format
│   ├── notebooks			- Used in order to explore both data and the different functionalities
│   ├── references			- Some files with links or relevant information for the notebooks
│   ├── reports				- Reports generated by notebooks, not in .ipynb or .Rmd formats
│   ├── requirements.txt		- The requirements file for reproducing the analysis environment, e.g. generated with `pip freeze > requirements.txt`
│   ├── src				- Source code for use in this project
│   │   ├── __init__.py			- Makes src a Python module
│   │   ├── data			- Scripts to download or generate data
│   │   ├── deploy			- Scripts to turn raw data into features for modeling
│   │   ├── model			- Scripts to train models and then use trained models to make predictions
│   │   └── test			- Scripts or config files to test some functionalities before implementing in the application
│   └── wsgi.py				- Used by Gunicorn to start app.py
├── docker-compose.yml			- Manage our Docker containers assembling them
├── config-machine.md			- Guide for developers to deploy this repository
└── nginx				- Scripts related to Nginx configuration
    ├── Dockerfile			- File used by Docker to generate the image of the Nginx 
    └── nginx.conf			- Configure the web server
```

Generated using the following command ```tree . -I 'env'```

## How to run

To run this API server now you can try to build the docker file using *docker-compose* which creates an image of the two containers, one for nginx and the other for gunicorn. When launch the command ```docker-compose up```, these containers will be up and you can try now to make some request to the API.

For a detailed information [you can visit this guide](https://github.com/sergiobemar/tfg-sb-meal-delivery-prediction-api/blob/master/docs/config-machine.md) created in order to orient the developer in the deployment.

```
docker-compose build

docker-compose up
```

If you want to re-build the API, you only have to remove the old image and build the another newer, for this you only have to remove the created containers.

```
docker ps
docker-compose rm [IMAGE]
```

However, if you want to stop the Docker containers without being deleted, you only have to run this command from the main path:

```
docker-compose down
```

# Useful links
+ [Build a FastAPI Server](https://python-gino.org/docs/en/master/tutorials/fastapi.html)
+ [Install Docker Compose](https://docs.docker.com/compose/install/)
+ [Uvicorn - Deployment](https://www.uvicorn.org/deployment/#running-programmatically)
